2013. [6] Hugo Jacquin and A. Rancon. Resummed mean-field inference for strongly coupled data. Phys. Rev. E, 94:042118, Oct 2016. [7] Edwin T Jaynes.Probability theory: The logic of science. Cambridge university press, 2003. [8] Yoshiyuki Kabashima, Florent Krzakala, Marc Mezard, Ayaka Sakata, and Lenka Zdeborova. Phase transitions and sample complexity in bayes-optimal matrix factorization. IEEE Transactions on Information Theory, 62(7):4228-4265, 2016. [9] Tobias Kuhn and Moritz Helias. Expansion of the

and Florent Krzakala and. Statistical physics of inference: thresholds and algorithms.Advances in Physics, 65(5):453-552, 2016. [24] Jean Zinn-Justin.Quantum field theory and critical phenomena. Clarendon Press, Oxford, 1996.

147:252 - 314, 2012. [3] Antoine Georges and Jonathan S Yedidia. How to expand around mean-field theory using high-temperature expansions.Journal of Physics A: Mathematical and General, 24(9):2173, 1991. [4] A. Guionnet and M. Maida. A fourier view on the r-transform and related asymptotics of spherical integrals. Journal of Functional Analysis, 222(2):435- 490, 2005. [5] Jean-Pierre Hansen and Ian Ranald McDonald.Theory of simple liquids: with applications to soft matter. Academic press, 2013. [6] Hugo

= 1 Z (j, k, K)e P i(jini+kin2 i )+P i=j Kijninj and the corresponding entropy therefore is S = * - X i jini + kin2 i - X i=j Kijninj + n + ln (Z (j, k, K)) . We can express that fact that the source fields are chosen such that the first two moments of the model fit the measured ones by adding a supremum, yielding S = sup j,k,K * - X i jini + kin2 i - X i=j Kijninj + n + ln (Z (j, k, K)) =-c [m, v, c].(37) We note in passing that this is also consistent with the thermodynamic definition of the (Helmholtz)

contributions to Ac are insubstantial because they generate diagrams of different topologies by construction. While the resummation of rings diagrams is usually an ad-hoc approach, there are cases in which it can we justified: if the covariances obey the mean-field scaling1/N with N the number of spins for example, the ring diagrams are the dominating ones forN . 3.3. Ising model The Ising model is special, because due to its binary character, one source field fixes all single-unit moments. This means that

the following types of diagrams cancel: (i) Cactus diagrams (ii) Pseudo-cactus diagrams without crossing identifications Before closing this section, we note that we did not characterize all diagrams contributing to K, but only those of the same type as those contributing toW. Towards data analysis with diagrammatics 10 However, K includes of course contributions with cumulants of orders higher than 2. Differentiating those with respect tomi or vi requires to take the derivative of the cumulant with

now a much more natural and shorter derivation. A similar simplification of the Ising diagrammatics was already presented in [20-22, sec. 6.3.4.], however, featuring a quite technical derivation without link to Legendre transforms with respect to higher-oder source fields. Towards data analysis with diagrammatics 17 3.3.2. The ring resummation in the Ising model The fact that for the Ising model Legendre transforms with respect to arbitrarily many source fields are identical to the first Legendre transform

them that one with the highest entropy [7]. For binary variables with given means and covariances, the resulting probability distribution is that of an Ising spin glass, which is therefore a widespread tool in the modeling of complex systems. While with the first scenario of an a-priori given theoretical model with known parameters we are invoking a forward problem, we address an inverse problem in the second case: finding the parameters of a model given some observations. In both scenarios, computing the

Legendre transform justifies the resummation of the ring diagrams expressed by matrix products for the Ising model as performed in [2, 19]. In particular, with this results, we can explain an observation of Cocco and Monasson [2, appendix B]. They note that a diagram depicting a term in their small-correlation expansion (the middle one in the second column of their figure 26) contributes with the same prefactor to the entropy as the corresponding term to what they call the mean-field approximation of the

and Experiment, 2022(8):083301, aug 2022. REFERENCES 21 [14] K Nakanishi and H Takayama. Mean-field theory for a spin-glass model of neural networks: Tap free energy and the paramagnetic to spin-glass transition. 30:8085- 8094, 1997. [15] Liam Paninski. Estimation of entropy and mutual information. Neural Computation, 15(6):1191-1253, 06 2003. [16] Silvia Pappalardi, Laura Foini, and Jorge Kurchan. Eigenstate thermalization hypothesis and free probability.Phys. Rev. Lett., 129:170603, Oct 2022. [17] G

prefactor in all of the cases, which are "dangerous" in the sense of Maillard et al., that is, in the case of sticking together together simple cycles. 3.2. The Gaussian Legendre transform as a (maximum) entropy An important application of our results on the joint Legendre transform with respect to j, k and K is to estimate the maximum value for the entropy given the first two moments of some data set. The corresponding probability distribution is indeed given by [7] PMaxEnt (n) = 1 Z (j, k, K)e P

2 X i=j X k,l(=i,j) KikvkKkjvjKjlvlKlivi - 1 4 X i=j X k,l(=,j) KikvkKkjvjKjlvlKlivi (31) + 1 2 X i=j X k(=i,j) viK2 ikv2 kK2 jkvj - 1 4 X i=j X k(=i,j) viK2 ikv2 kK2 jkvj (32) = 1 8 X i=j=k=l=i, i=k,j=l KikvkKkjvjKjlvjKlivi + 1 4 X i=j X k(=i,j) viK2 ikv2 kK2 jkvj + 1 8 X i=j viv4 i K4 ijv4 j ,(33) Towards data analysis with diagrammatics 13 which can be rewritten as 1 8 X i=j=k=l=i KikvkKkjvjKjlvjKlivi = 1 8tr (Kv)4 . In other words: fixing also the (on-site) variance, in addition to the covariances,

In particular, it allowed us to complete the proof of a result on a system characterized by a rotationally invariant matrix, which so far has only been conjectured [12], and to derive, on a theoretically grounded way, a practical approximation for the entropy of a complex system of which only a limited amount of statistics is available [10]. So while the present manuscript, as we believe, is a valid contribution because it relates known results to each other, thereby allows to better understand them and

node and either go clockwise or counter-clockwise. Then, all24 possible vertex flips generate new labeled diagrams, so that the symmetry factor is as Towards data analysis with diagrammatics 7 ... ... ... a b Figure 1. Sketch of (a) a cactus diagram and (b) an improper pseudo-cactus diagram. indicated in the second bracket. While this is true of the ring diagrams without restrictions we here obtain an additional factor2 because of the two possibilities to identify pairs of opposite nodes bearing the same

has been made, and equation (5) is fully exact. Next, we will use this expression to set up the small-coupling expansion for the quantityK. WeseparatetheHamiltonianandthefreeenergiesintoasolvableandaperturbing part, according to K = K 0 + K v and analogous forH and W. Plugging this decomposition into equation (5), isolating -K v on the left-hand side, reuniting theK 0 with its derivatives to re-obtainW0, we get exp -K v [m, v] = e-W0[j0,k0] e -HV [ j ]+ K m T ( j -m)+ K v h ( j -m) 2 -v i eW0[j,k0]

equation (3) and equation (4), through which we express j and k, to arrive at exp -H [] + jT + 1 2TK = exp (W [j, K]) = exp mTj + v + m2T k - K [, ] = exp mT K m - 2K v m + v + m2T K v - K [m, v] , Towards data analysis with diagrammatics 4 where by we denote element-wise multiplication. We finally isolateK and replace the field by its expression as a derivative with respect toj. This leads to exp -K [m, v] = X exp -H [] + ( - m)T K m - 2K v m + K v 2 - m2 - v (5) At this stage, no approximation has been

and Theoretical, 42(5):055001, 2009. [20] A. N. Vasiliev and R. A. Radzhabov. Legendre transforms in the ising model. Theoretical and Mathematical Physics, 21(1):963-970, 1974. [21] A. N. Vasiliev and R. A. Radzhabov. Analysis of the nonstar graphs of the legendre transform in the ising model. Theoretical and Mathematical Physics, 23(3):575-579, Jun 1975. [22] Aleksandr Nikolaevich Vasiliev.Functional methods in quantum field theory and statistical physics. Routledge, 2019. [23] Lenka Zdeborova and Florent

the cumulant with respect toji and ki to obtain the dependence onmi and vi via the inner derivatives. The latter is basically basically given by the Hessian ofK 0 , which for completeness we derive in section 5.1. TheseK-derivatives serve as vertices in the construction of higher orders - the lowest one being6. However, in the application we will address in section 3.1, we do not need them because their contribution is sub-leadling in the thermodynamic limit. 2.2. The Gaussian Legendre transform:c In

et al. set up a small-coupling expansion. It is, however, not diagrammatic; the diagrams they are drawing are depictions of the terms they have derived by other means. In addition, they build on a result from random-matrix theory by Guionnet et al. [4] to show that out of these contributions only those remain that they call simple cycles and cacti, all other vanish in the thermodynamic limit of N . Their simple cycle (see their sec. 5.2) corresponds to a ring diagram with all indices pairwise unequal in

of high-dimensional statistics, like matrix factorization, and the study of complex networks. arXiv:2504.03631v1 [cond-mat.stat-mech] 4 Apr 2025 Towards data analysis with diagrammatics 2 1. Introduction A lot of interesting and challenging problems in physics are composed of multiple complicated, but well characterized components, who interact in a pairwise fashion. This concerns, for example, spin systems (Ising, Potts, XY, Heisenberg, p-spin,...), in which the single components are connected by pairwise